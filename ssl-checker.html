<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SSL Certificate Checker | Node12.com</title>
    <style>
        /* Basic Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            line-height: 1.6;
            color: #333;
            background-color: #f8f9fa;
        }
        
        /* Navigation */
        .navbar {
            background: linear-gradient(to right, #2563eb, #4f46e5);
            color: white;
            padding: 1rem 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .container {
            width: 90%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }
        
        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .nav-links {
            display: flex;
            list-style: none;
        }
        
        .nav-links li {
            margin-left: 1.5rem;
        }
        
        .nav-links a {
            color: white;
            text-decoration: none;
            transition: opacity 0.3s;
        }
        
        .nav-links a:hover {
            opacity: 0.8;
        }
        
        /* Main Content */
        .main-content {
            padding: 3rem 0;
        }
        
        .page-title {
            text-align: center;
            margin-bottom: 2rem;
        }
        
        .page-title h1 {
            font-size: 2.5rem;
            color: #2563eb;
            margin-bottom: 0.5rem;
        }
        
        .page-title p {
            color: #6b7280;
            font-size: 1.1rem;
        }
        
        /* SSL Check Form */
        .ssl-check-form {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 2rem;
            margin-bottom: 2rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .input-group {
            display: flex;
        }
        
        .form-control {
            flex: 1;
            padding: 0.75rem;
            border: 1px solid #d1d5db;
            border-radius: 4px 0 0 4px;
            font-size: 1rem;
        }
        
        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0 4px 4px 0;
            background-color: #2563eb;
            color: white;
            font-weight: 500;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .btn:hover {
            background-color: #1d4ed8;
        }
        
        /* Results Section */
        .results-section {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            padding: 2rem;
            display: none;
        }
        
        .results-section.show {
            display: block;
        }
        
        .results-header {
            padding-bottom: 1rem;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
        }
        
        .results-title {
            font-size: 1.5rem;
            color: #2563eb;
        }
        
        .domain-name {
            font-weight: bold;
        }
        
        .result-row {
            display: flex;
            justify-content: space-between;
            padding: 1rem 0;
            border-bottom: 1px solid #f3f4f6;
        }
        
        .result-label {
            font-weight: 500;
            color: #4b5563;
        }
        
        .result-value {
            font-weight: 500;
        }
        
        .valid {
            color: #10b981;
        }
        
        .warning {
            color: #f59e0b;
        }
        
        .invalid {
            color: #ef4444;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            display: none;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #2563eb;
            border-radius: 50%;
            margin: 0 auto 1rem;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Footer */
        footer {
            background-color: #333;
            color: white;
            padding: 3rem 0;
            text-align: center;
            margin-top: 3rem;
        }
        
        .footer-links {
            display: flex;
            justify-content: center;
            list-style: none;
            margin: 1.5rem 0;
        }
        
        .footer-links li {
            margin: 0 1rem;
        }
        
        .footer-links a {
            color: white;
            text-decoration: none;
            opacity: 0.8;
            transition: opacity 0.3s;
        }
        
        .footer-links a:hover {
            opacity: 1;
        }
        
        .copyright {
            opacity: 0.7;
            font-size: 0.9rem;
            margin-top: 1.5rem;
        }
        
        /* Responsive Design */
        @media (max-width: 768px) {
            .nav-container {
                flex-direction: column;
            }
            
            .nav-links {
                margin-top: 1rem;
            }
            
            .nav-links li {
                margin: 0 0.7rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="container nav-container">
            <div class="logo">Node12.com</div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/ssl-checker.html">SSL Checker</a></li>
                <li><a href="#">Features</a></li>
                <li><a href="#">Contact</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- Main Content -->
    <div class="main-content">
        <div class="container">
            <div class="page-title">
                <h1>SSL Certificate Checker</h1>
                <p>Verify SSL certificate status for any domain</p>
            </div>
            
            <!-- SSL Check Form -->
            <div class="ssl-check-form">
                <div class="form-group">
                    <label for="domain">Enter Domain Name</label>
                    <div class="input-group">
                        <input type="text" id="domain" class="form-control" placeholder="example.com" required>
                        <button type="button" id="check-btn" class="btn">Check SSL</button>
                    </div>
                </div>
            </div>
            
            <!-- Loading Indicator -->
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Checking SSL certificate...</p>
            </div>
            
            <!-- Results Section -->
            <div class="results-section" id="results">
                <div class="results-header">
                    <h2 class="results-title">SSL Certificate Results for <span id="result-domain" class="domain-name">example.com</span></h2>
                </div>
                
                <div class="result-row">
                    <div class="result-label">Status</div>
                    <div class="result-value" id="result-status">Valid</div>
                </div>
                
                <div class="result-row">
                    <div class="result-label">Issuer</div>
                    <div class="result-value" id="result-issuer">Let's Encrypt Authority X3</div>
                </div>
                
                <div class="result-row">
                    <div class="result-label">Valid From</div>
                    <div class="result-value" id="result-valid-from">May 1, 2025</div>
                </div>
                
                <div class="result-row">
                    <div class="result-label">Valid Until</div>
                    <div class="result-value" id="result-valid-to">July 30, 2025</div>
                </div>
                
                <div class="result-row">
                    <div class="result-label">Days Remaining</div>
                    <div class="result-value" id="result-days">78 days</div>
                </div>
                
                <!-- Error Information (only shown when there's an error) -->
                <div class="result-row" id="error-container" style="display: none;">
                    <div class="result-label">Error Details</div>
                    <div class="result-value invalid" id="result-error">No errors</div>
                </div>
                
                <!-- Browser Explanation -->
                <div class="result-row" style="margin-top: 20px; flex-direction: column;">
                    <div class="result-label" style="margin-bottom: 10px;">What This Means for Browsers</div>
                    <div class="result-value" id="browser-explanation" style="font-size: 0.9rem; line-height: 1.5;">
                        When a certificate is invalid, browsers will show a security warning like "Your connection is not private." 
                        This happens when there are issues such as self-signed certificates, expired certificates, 
                        or certificates not matching the domain name.
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="logo">Node12.com</div>
            <ul class="footer-links">
                <li><a href="/">Home</a></li>
                <li><a href="#">About</a></li>
                <li><a href="#">Services</a></li>
                <li><a href="#">Contact</a></li>
                <li><a href="#">Privacy Policy</a></li>
            </ul>
            <div class="copyright">Copyright Â© 2025 Node12.com. All rights reserved.</div>
        </div>
    </footer>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const domainInput = document.getElementById('domain');
            const checkBtn = document.getElementById('check-btn');
            const loadingDiv = document.getElementById('loading');
            const resultsDiv = document.getElementById('results');
            const resultDomain = document.getElementById('result-domain');
            const resultStatus = document.getElementById('result-status');
            const resultIssuer = document.getElementById('result-issuer');
            const resultValidFrom = document.getElementById('result-valid-from');
            const resultValidTo = document.getElementById('result-valid-to');
            const resultDays = document.getElementById('result-days');
            
            // Check SSL certificate when button is clicked
            checkBtn.addEventListener('click', function() {
                const domain = domainInput.value.trim();
                if (!domain) {
                    alert('Please enter a domain name');
                    return;
                }
                
                // Show loading indicator
                loadingDiv.style.display = 'block';
                resultsDiv.classList.remove('show');
                
                // Simulate API call with setTimeout
                setTimeout(function() {
                    checkSSL(domain);
                }, 1500);
            });
            
            // Allow pressing Enter to submit
            domainInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkBtn.click();
                }
            });
            
            // Function to check SSL certificate
            function checkSSL(domain) {
                // Show the original domain in the results
                const displayDomain = domain;
                
                // Always add link to SSL Labs for independent verification
                const sslLabsLink = document.createElement('div');
                sslLabsLink.className = 'mt-4 info-box';
                sslLabsLink.innerHTML = `
                    <strong>External Verification:</strong> 
                    <a href="https://www.ssllabs.com/ssltest/analyze.html?d=${domain}" target="_blank" rel="noopener">
                        View detailed SSL report at SSL Labs
                    </a>
                    <p class="mt-2 text-sm">SSL Labs provides independent verification of certificate validity and security ratings.</p>
                `;
                
                // Add this element to the form after submission
                const existingLink = document.querySelector('.info-box');
                if (existingLink) {
                    existingLink.remove(); // Remove existing link if present
                }
                document.querySelector('.check-form').appendChild(sslLabsLink);
                
                // For all other domains, use the API
                fetch('/api/csrf-token')
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Failed to get CSRF token');
                        }
                        return response.json();
                    })
                    .then(tokenData => {
                        // Make the API call to our backend with CSRF token
                        const url = `/api/check-ssl?domain=${encodeURIComponent(domain)}&_csrf=${tokenData.csrfToken}`;
                        return fetch(url, {
                            headers: {
                                'CSRF-Token': tokenData.csrfToken
                            }
                        });
                    })
                    .then(response => {
                        if (!response.ok) {
                            throw new Error('Network response was not ok');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // Update the UI with the results
                        resultDomain.textContent = displayDomain;
                        
                        const errorContainer = document.getElementById('error-container');
                        const resultError = document.getElementById('result-error');
                        const browserExplanation = document.getElementById('browser-explanation');
                        
                        if (data.valid) {
                            resultStatus.textContent = 'Valid';
                            resultStatus.className = 'result-value valid';
                            
                            // Hide error details
                            errorContainer.style.display = 'none';
                            
                            // Update browser explanation
                            browserExplanation.innerHTML = 
                                'This certificate is valid and secure. Browsers will show a padlock icon and allow ' + 
                                'secure connections without warnings. Users can safely enter sensitive information ' +
                                'on this site.';
                        } else {
                            resultStatus.textContent = 'Invalid';
                            resultStatus.className = 'result-value invalid';
                            
                            // Show error details if available
                            if (data.error) {
                                errorContainer.style.display = 'flex';
                                resultError.textContent = data.error;
                                
                                // Customize the browser explanation based on the error
                                if (data.error.includes('Hostname/IP does not match certificate') || 
                                    data.error.includes('altnames') || 
                                    data.error.includes('CERT_COMMON_NAME_INVALID')) {
                                    
                                    // Special case for www.node12.com domain
                                    if (displayDomain.includes('www.node12.com')) {
                                        browserExplanation.innerHTML = 
                                            '<strong>Domain Mismatch Error:</strong> The SSL certificate for www.node12.com is invalid. ' +
                                            '<br><br>' +
                                            '<strong>What\'s happening:</strong><br>' +
                                            '1. The certificate was issued for "node12.com" (without www)<br>' +
                                            '2. When accessing www.node12.com, browsers show a security warning<br>' +
                                            '3. This is a common issue with SSL certificates that don\'t include the www subdomain<br><br>' +
                                            '<strong>How to fix:</strong><br>' +
                                            '- If using Replit, follow <a href="https://docs.replit.com/hosting/hosting-web-pages/custom-domains" target="_blank">Replit\'s guide for setting up custom domains</a><br>' +
                                            '- Make sure to add both node12.com AND www.node12.com in your Replit domain settings<br>' +
                                            '- Update your DNS records to include proper CNAME records for the www subdomain';
                                    } else {
                                        browserExplanation.innerHTML = 
                                            '<strong>Domain Mismatch Error:</strong> The SSL certificate is not valid for this domain name. ' +
                                            'This happens when:<br><br>' +
                                            '1. The certificate was issued for a different domain (e.g., for "*.replit.app" but used on "' + displayDomain + '")<br>' +
                                            '2. You\'re using a custom domain that points to a hosting service without proper SSL setup<br>' +
                                            '3. There\'s a misconfiguration in the DNS or hosting setup<br><br>' +
                                            '<strong>How to fix:</strong><br>' +
                                            '- If using a custom domain with Replit, follow <a href="https://docs.replit.com/hosting/hosting-web-pages/custom-domains" target="_blank">Replit\'s guide for setting up custom domains</a><br>' +
                                            '- Purchase a properly issued SSL certificate for this domain<br>' +
                                            '- Set up proper SSL certificate binding for this domain on your hosting provider';
                                    }
                                        
                                } else if (data.error.includes('CERT_HAS_EXPIRED')) {
                                    browserExplanation.innerHTML = 
                                        '<strong>Expired Certificate:</strong> The certificate has expired. The site owner needs to renew the SSL certificate. ' +
                                        'Browsers will show a security warning until this is fixed.';
                                } else if (data.error.includes('UNABLE_TO_VERIFY_LEAF_SIGNATURE')) {
                                    browserExplanation.innerHTML = 
                                        '<strong>Untrusted Certificate:</strong> This appears to be a self-signed certificate or one not issued by a trusted authority. ' +
                                        'Browsers will display a security warning when users visit this site.';
                                } else {
                                    browserExplanation.innerHTML = 
                                        '<strong>Certificate Validation Error:</strong> This certificate has validation issues. Browsers will show security warnings ' +
                                        'when users try to access this site. Users will need to click through security ' +
                                        'warnings, which is not recommended for sensitive information.';
                                }
                            } else {
                                errorContainer.style.display = 'none';
                                browserExplanation.innerHTML = 
                                    'This certificate has validation issues. Browsers will show security warnings ' +
                                    'when users try to access this site.';
                            }
                        }
                        
                        resultIssuer.textContent = data.issuer || 'N/A';
                        resultValidFrom.textContent = data.validFrom ? new Date(data.validFrom).toLocaleDateString() : 'N/A';
                        resultValidTo.textContent = data.validTo ? new Date(data.validTo).toLocaleDateString() : 'N/A';
                        
                        if (data.daysRemaining) {
                            resultDays.textContent = `${data.daysRemaining} days`;
                            
                            if (data.daysRemaining < 30) {
                                resultDays.className = 'result-value warning';
                            } else {
                                resultDays.className = 'result-value';
                            }
                        } else {
                            resultDays.textContent = 'N/A';
                            resultDays.className = 'result-value';
                        }
                        
                        // Hide loading and show results
                        loadingDiv.style.display = 'none';
                        resultsDiv.classList.add('show');
                    })
                    .catch(error => {
                        console.error('Error checking SSL:', error);
                        alert('Error checking SSL certificate. Please try again.');
                        loadingDiv.style.display = 'none';
                    });
            }
        });
    </script>
</body>
</html>